<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>53.0</apiVersion>
    <assignments>
        <name>Addcontacttolist</name>
        <label>Add contact to list</label>
        <locationX>754</locationX>
        <locationY>1440</locationY>
        <assignmentItems>
            <assignToReference>ContactsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Iteratethroughcontacts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Iteratethroughcontacts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignSelectedContact</name>
        <label>Assign Selected Contact</label>
        <locationX>446</locationX>
        <locationY>708</locationY>
        <assignmentItems>
            <assignToReference>SelectedContact</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LoopContacts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>LoopContacts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Contact_As_Inactive</name>
        <label>Set Contact As Inactive</label>
        <locationX>1634</locationX>
        <locationY>600</locationY>
        <assignmentItems>
            <assignToReference>Loop_through_contacts.IsInactive__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_contacts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetContactInfo</name>
        <label>Set Contact Info</label>
        <locationX>754</locationX>
        <locationY>1332</locationY>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_accId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.Email</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_email</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_firstName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_lastName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.MailingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_city</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.MailingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_country</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.MailingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_postalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.MailingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_street</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.MiddleName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_prefix</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.OtherCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_privCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.OtherCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_privCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.OtherPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_privPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.OtherStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_privStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.Phone</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_Phone</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.PrivateEmail__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_privEmail</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Iteratethroughcontacts.TeacherNumber__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>form_update_teacherNum</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Addcontacttolist</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>SortContacts</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sort Contacts</label>
        <locationX>358</locationX>
        <locationY>492</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>GetContacts</collectionReference>
        <connector>
            <targetReference>LoopContacts</targetReference>
        </connector>
        <limit>1</limit>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>IsInactive__c</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>CreatedDate</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <decisions>
        <name>DoesContact_Exist</name>
        <label>Does Contact Exist?</label>
        <locationX>358</locationX>
        <locationY>1116</locationY>
        <defaultConnector>
            <targetReference>Iteratethroughcontacts</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ContactDoesNotExist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetContacts</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CreateContact</targetReference>
            </connector>
            <label>Contact Does Not Exist</label>
        </rules>
    </decisions>
    <decisions>
        <name>Last_Modified_was_10_days_ago</name>
        <label>Last Modified was 10 days ago</label>
        <locationX>1678</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesLastModified</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.LastModifiedDate</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>form_tenDaysAgo</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contact__r.IsInactive__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Copy_1_of_Get_Contacts</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Should_Run</name>
        <label>Should Run?</label>
        <locationX>776</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>bValueshaveChanged</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>GetContacts</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>CH 16/05/2023: Enabled updating of contacts</description>
    <environments>Default</environments>
    <formulas>
        <name>bValueshaveChanged</name>
        <dataType>Boolean</dataType>
        <expression>OR(
ISCHANGED({!$Record.CITY__c}),
ISCHANGED({!$Record.COUNTRY__c}),
ISCHANGED({!$Record.DELETE_CODE__c}),
ISCHANGED({!$Record.DOCNR__c}),
ISCHANGED({!$Record.EMAIL_COMMUNICATION_NUMBER__c}),
ISCHANGED({!$Record.EXCLUDEFROMMAIL__c}),
ISCHANGED({!$Record.FAX_CITY_PREFIX__c}),
ISCHANGED({!$Record.FAX_COMMUNICATION_NUMBER__c}),
ISCHANGED({!$Record.FAX_COUNTRY_PREFIX__c}),
ISCHANGED({!$Record.FIRST_NAME__c}),
ISCHANGED({!$Record.ID_ADDRESS__c}),
ISCHANGED({!$Record.ID_JURISTIC_PERSON__c}),
ISCHANGED({!$Record.ID_LOCATION__c}),
ISCHANGED({!$Record.IS_INSTITUUT_ADDRESS__c}),
ISCHANGED({!$Record.KlopotekCountry__c}),
ISCHANGED({!$Record.NAME__c}),
ISCHANGED({!$Record.NAME_ADDRESS_ADDON1__c}),
ISCHANGED({!$Record.NAME_ADDRESS_ADDON2__c}),
ISCHANGED({!$Record.NAME_ADDRESS_ADDON3__c}),
ISCHANGED({!$Record.PO_BOX_NUMBER__c}),
ISCHANGED({!$Record.PO_DESCR__c}),
ISCHANGED({!$Record.POSTAL_CODE__c}),
ISCHANGED({!$Record.PREFIX__c}),
ISCHANGED({!$Record.ROWNUM__c}),
ISCHANGED({!$Record.SEX__c}),
ISCHANGED({!$Record.STREET__c}),
ISCHANGED({!$Record.STREET_NUMBER__c}),
ISCHANGED({!$Record.TEL_CITY_PREFIX__c}),
ISCHANGED({!$Record.TEL_COMMUNICATION_NUMBER__c}),
ISCHANGED({!$Record.TEL_COUNTRY_PREFIX__c}),
ISCHANGED({!$Record.TEL06_CITY_PREFIX__c}),
ISCHANGED({!$Record.TEL06_COMMUNICATION_NUMBER__c}),
ISCHANGED({!$Record.TEL06_COUNTRY_PREFIX__c}),
ISCHANGED({!$Record.TITLE__c}),
ISCHANGED({!$Record.TITLE_CODE__c}),
ISCHANGED({!$Record.UDB_ID__c}),
ISCHANGED({!$Record.URL_COMMUNICATION_NUMBER__c}))</expression>
    </formulas>
    <formulas>
        <name>forContactId</name>
        <dataType>String</dataType>
        <expression>IF(NOT(ISBLANK({!varCreatedContactId})),{!varCreatedContactId},{!SelectedContact.Id})</expression>
    </formulas>
    <formulas>
        <name>forEmail</name>
        <dataType>String</dataType>
        <expression>IF(NOT(REGEX(UPPER({!GetKlopotekAccountContactRelationship.EMAIL_COMMUNICATION_NUMBER__c}) ,&quot;^[A-Z0-9._%+-/!#$%&amp;&apos;*=?^_`{|}~]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$&quot;)),&quot;check.email@klopotek.com&quot;,{!GetKlopotekAccountContactRelationship.EMAIL_COMMUNICATION_NUMBER__c})</expression>
    </formulas>
    <formulas>
        <name>forFaultMessage</name>
        <dataType>String</dataType>
        <expression>LEFT({!$Flow.FaultMessage},Find(&quot;You can look up ExceptionCode&quot;, {!$Flow.FaultMessage})-1)</expression>
    </formulas>
    <formulas>
        <name>forLastName</name>
        <dataType>String</dataType>
        <expression>IF(NOT(ISBLANK({!$Record.NAME__c})),{!$Record.NAME__c},&quot;NULL&quot;)</expression>
    </formulas>
    <formulas>
        <name>form_tenDaysAgo</name>
        <dataType>Date</dataType>
        <expression>TODAY()-10</expression>
    </formulas>
    <formulas>
        <name>form_update_accId</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.Id}),{!Iteratethroughcontacts.AccountId}, {!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.Id})</expression>
    </formulas>
    <formulas>
        <name>form_update_city</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCity}), {!Iteratethroughcontacts.MailingCity}, {!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCity})</expression>
    </formulas>
    <formulas>
        <name>form_update_country</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCountry}), {!Iteratethroughcontacts.MailingCountry}, {!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCountry})</expression>
    </formulas>
    <formulas>
        <name>form_update_email</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!forEmail}), {!Iteratethroughcontacts.Email}, {!forEmail})</expression>
    </formulas>
    <formulas>
        <name>form_update_firstName</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.FIRST_NAME__c}), {!Iteratethroughcontacts.FirstName}, {!$Record.FIRST_NAME__c})</expression>
    </formulas>
    <formulas>
        <name>form_update_lastName</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!forLastName}), {!Iteratethroughcontacts.LastName}, {!forLastName})</expression>
    </formulas>
    <formulas>
        <name>form_update_Phone</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!forPhone}), {!Iteratethroughcontacts.Phone}, {!forPhone})</expression>
    </formulas>
    <formulas>
        <name>form_update_postalCode</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingPostalCode}), {!Iteratethroughcontacts.MailingPostalCode}, {!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingPostalCode})</expression>
    </formulas>
    <formulas>
        <name>form_update_prefix</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.PREFIX__c}), {!Iteratethroughcontacts.MiddleName}, {!$Record.PREFIX__c})</expression>
    </formulas>
    <formulas>
        <name>form_update_privCity</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.CITY__c}), {!Iteratethroughcontacts.OtherCity}, {!$Record.CITY__c})</expression>
    </formulas>
    <formulas>
        <name>form_update_privCountry</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetCountry.COUNTRY_NAME_ENGLISH__c}), {!Iteratethroughcontacts.OtherCountry}, {!GetCountry.COUNTRY_NAME_ENGLISH__c})</expression>
    </formulas>
    <formulas>
        <name>form_update_privEmail</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!forPrivateEmail}), {!Iteratethroughcontacts.PrivateEmail__c}, {!forPrivateEmail})</expression>
    </formulas>
    <formulas>
        <name>form_update_privPostalCode</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.POSTAL_CODE__c}), {!Iteratethroughcontacts.OtherPostalCode}, {!$Record.POSTAL_CODE__c})</expression>
    </formulas>
    <formulas>
        <name>form_update_privStreet</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!forStreet}), {!Iteratethroughcontacts.OtherStreet}, {!forStreet})</expression>
    </formulas>
    <formulas>
        <name>form_update_street</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingStreet}), {!Iteratethroughcontacts.MailingStreet}, {!GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingStreet})</expression>
    </formulas>
    <formulas>
        <name>form_update_teacherNum</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.DOCNR__c}), {!Iteratethroughcontacts.TeacherNumber__c}, {!$Record.DOCNR__c})</expression>
    </formulas>
    <formulas>
        <name>forPhone</name>
        <dataType>String</dataType>
        <expression>IF(AND(NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c})),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c})),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c}))),{!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c} &amp; &quot;-&quot; &amp; {!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c} &amp; &quot;-&quot; &amp; {!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c},
IF(AND(NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c})),ISBLANK({!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c}),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c}))),{!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c} &amp; &quot;-&quot; &amp; {!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c},
IF(AND(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c}),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c})),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c}))),{!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c} &amp; &quot;-&quot; &amp; {!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c},
IF(AND(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COUNTRY_PREFIX__c}),ISBLANK({!GetKlopotekAccountContactRelationship.TEL_CITY_PREFIX__c}),NOT(ISBLANK({!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c}))),{!GetKlopotekAccountContactRelationship.TEL_COMMUNICATION_NUMBER__c},&quot;&quot;))))</expression>
    </formulas>
    <formulas>
        <name>forPrivateEmail</name>
        <dataType>String</dataType>
        <expression>IF(NOT(REGEX(UPPER({!$Record.EMAIL_COMMUNICATION_NUMBER__c}) ,&quot;^[A-Z0-9._%+-/!#$%&amp;&apos;*=?^_`{|}~]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$&quot;)),&quot;check.email@klopotek.com&quot;,{!$Record.EMAIL_COMMUNICATION_NUMBER__c})</expression>
    </formulas>
    <formulas>
        <name>forStreet</name>
        <dataType>String</dataType>
        <expression>{!$Record.STREET__c} &amp; &quot; &quot; &amp; {!$Record.STREET_NUMBER__c}</expression>
    </formulas>
    <interviewLabel>Convert {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Convert Klopotek Contact</label>
    <loops>
        <name>Iteratethroughcontacts</name>
        <label>Iterate through contacts</label>
        <locationX>666</locationX>
        <locationY>1224</locationY>
        <collectionReference>GetContacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>SetContactInfo</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>UpdateContacts</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_through_contacts</name>
        <label>Loop through contacts</label>
        <locationX>1546</locationX>
        <locationY>492</locationY>
        <collectionReference>Copy_1_of_Get_Contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Contact_As_Inactive</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Contacts</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LoopContacts</name>
        <label>Loop Contacts</label>
        <locationX>358</locationX>
        <locationY>600</locationY>
        <collectionReference>GetContacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>AssignSelectedContact</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>GetCountry</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>CreateContact</name>
        <label>Create Contact</label>
        <locationX>50</locationX>
        <locationY>1224</locationY>
        <assignRecordIdToReference>varCreatedContactId</assignRecordIdToReference>
        <connector>
            <targetReference>UpdateKlopotekContact</targetReference>
        </connector>
        <faultConnector>
            <targetReference>UpdateConvertError</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CommunicationLanguage__c</field>
            <value>
                <stringValue>Dutch</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email</field>
            <value>
                <elementReference>forEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FirstName</field>
            <value>
                <elementReference>$Record.FIRST_NAME__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LastName</field>
            <value>
                <elementReference>forLastName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MailingCity</field>
            <value>
                <elementReference>GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCity</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MailingCountry</field>
            <value>
                <elementReference>GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingCountry</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MailingPostalCode</field>
            <value>
                <elementReference>GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingPostalCode</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MailingStreet</field>
            <value>
                <elementReference>GetKlopotekAccountContactRelationship.KlopotekAccount__r.Account__r.ShippingStreet</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MiddleName</field>
            <value>
                <elementReference>$Record.PREFIX__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OperatingCompany__c</field>
            <value>
                <stringValue>Noordhoff</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OtherCity</field>
            <value>
                <elementReference>$Record.CITY__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OtherCountry</field>
            <value>
                <elementReference>GetCountry.COUNTRY_NAME_ENGLISH__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OtherPostalCode</field>
            <value>
                <elementReference>$Record.POSTAL_CODE__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OtherStreet</field>
            <value>
                <elementReference>forStreet</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Phone</field>
            <value>
                <elementReference>forPhone</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PrivateEmail__c</field>
            <value>
                <elementReference>forPrivateEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TeacherNumber__c</field>
            <value>
                <elementReference>$Record.DOCNR__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordCreates>
    <recordLookups>
        <name>Copy_1_of_Get_Contacts</name>
        <label>Get Contacts</label>
        <locationX>1546</locationX>
        <locationY>384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_through_contacts</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>TeacherNumber__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.DOCNR__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>OperatingCompany__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Noordhoff</stringValue>
            </value>
        </filters>
        <filters>
            <field>AccountId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetContacts</name>
        <label>Get Contacts</label>
        <locationX>358</locationX>
        <locationY>384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SortContacts</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>TeacherNumber__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.DOCNR__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>OperatingCompany__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Noordhoff</stringValue>
            </value>
        </filters>
        <filters>
            <field>AccountId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetCountry</name>
        <label>Get Country</label>
        <locationX>358</locationX>
        <locationY>900</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>GetKlopotekAccountContactRelationship</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>COUNTRY_CODE__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.COUNTRY__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>KlopotekCountry__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetKlopotekAccountContactRelationship</name>
        <label>Get Klopotek Account Contact Relationship</label>
        <locationX>358</locationX>
        <locationY>1008</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>DoesContact_Exist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DOCNR__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.DOCNR__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>KlopotekAccountContactRelationship__c</object>
        <sortField>RowNumber__c</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Copy_2_of_Update_Convert_Error</name>
        <label>Update Convert Error</label>
        <locationX>930</locationX>
        <locationY>1740</locationY>
        <inputAssignments>
            <field>ConvertError__c</field>
            <value>
                <elementReference>forFaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contacts</name>
        <label>Update Contacts</label>
        <locationX>1546</locationX>
        <locationY>792</locationY>
        <inputReference>Loop_through_contacts</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateContacts</name>
        <label>Update Contacts</label>
        <locationX>666</locationX>
        <locationY>1632</locationY>
        <connector>
            <targetReference>UpdateKlopotekContact</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Copy_2_of_Update_Convert_Error</targetReference>
        </faultConnector>
        <inputReference>ContactsToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateConvertError</name>
        <label>Update Convert Error</label>
        <locationX>314</locationX>
        <locationY>1332</locationY>
        <inputAssignments>
            <field>ConvertError__c</field>
            <value>
                <elementReference>forFaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateKlopotekAccountContactRelationships</name>
        <label>Update Klopotek Account Contact Relationships</label>
        <locationX>358</locationX>
        <locationY>2172</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DOCNR__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.DOCNR__c</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>KlopotekContact__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>KlopotekAccountContactRelationship__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateKlopotekContact</name>
        <label>Update Klopotek Contact</label>
        <locationX>358</locationX>
        <locationY>2064</locationY>
        <connector>
            <targetReference>UpdateKlopotekAccountContactRelationships</targetReference>
        </connector>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>forContactId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>KlopotekCountry__c</field>
            <value>
                <elementReference>GetCountry.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>1101</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Should_Run</targetReference>
        </connector>
        <object>KlopotekContact__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <scheduledPaths>
            <name>Mark_contact_as_inactive</name>
            <connector>
                <targetReference>Last_Modified_was_10_days_ago</targetReference>
            </connector>
            <label>Mark contact as inactive</label>
            <offsetNumber>10</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>LastModifiedDate</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>ContactsToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>SelectedContact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>varCreatedContactId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
