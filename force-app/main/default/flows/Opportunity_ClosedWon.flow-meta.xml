<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>OpportunityConvertHandler</name>
        <label>OpportunityConvertHandler</label>
        <locationX>689</locationX>
        <locationY>1125</locationY>
        <actionName>Order_OpportunityConvertHandler</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>getOrdertoUpdate</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>lstSingleOrderItem</name>
            <value>
                <elementReference>newOrderLineItemList</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Order_OpportunityConvertHandler</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>assContractVarsDate</name>
        <label>assContractVarsDate</label>
        <locationX>410</locationX>
        <locationY>1116</locationY>
        <assignmentItems>
            <assignToReference>startDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ServiceDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>AssItemtoList</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assContractVarsTerms</name>
        <label>assContractVarsTerms</label>
        <locationX>50</locationX>
        <locationY>758</locationY>
        <assignmentItems>
            <assignToReference>varContractTerms</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Terms__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decContractDate</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assEachOrderItem</name>
        <label>assEachOrderItem</label>
        <locationX>481</locationX>
        <locationY>677</locationY>
        <assignmentItems>
            <assignToReference>singleOrderItem.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>var_Order.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.PricebookEntryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Product2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ServiceDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ServiceDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.UnitPrice</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.NetsuiteQuantity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ProductType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Product2.Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ShipToAccount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Shipto__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.EndDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ProductEndDate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ListPriceDiscount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ListPriceDiscount__r.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ComponentListPrice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ComponentListPrice__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.StartDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ServiceDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ManualDiscount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ManualDiscount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ManualDiscountPercent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ManualDiscountPercent__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ManualDiscountValue__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ManualDiscountValue__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.Renewable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Renewable__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.Terms__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Terms__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.LicenseDuration__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.LicenseDuration__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.FormGroupId__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.FormGroupId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ProductComponent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ProductComponent__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.OpportunityProduct__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.CurrencyIsoCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.CurrencyIsoCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.DiscountedPriceItemGroup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.DiscountedPriceItemGroup__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.ListPriceItemGroup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.ListPriceItemGroup__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.NetSalesPriceItemGroup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.NetSalesPriceItemGroup__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>singleOrderItem.CustomerReference__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loopAddOpportunityItems.CustomerReference__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decContractTerms</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Default_BillTo_from_Account</name>
        <label>Assign Default BillTo from Account</label>
        <locationX>1687</locationX>
        <locationY>774</locationY>
        <assignmentItems>
            <assignToReference>var_Order.Billto__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.DefaultBillto__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.DefaultBillto__r.BillingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.DefaultBillto__r.BillingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.DefaultBillto__r.BillingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.DefaultBillto__r.BillingCity</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Order_Variables</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Opp_Account_as_BillTo</name>
        <label>Assign Opp Account as BillTo</label>
        <locationX>1673</locationX>
        <locationY>935</locationY>
        <assignmentItems>
            <assignToReference>var_Order.Billto__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.BillingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.BillingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.BillingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.BillingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.BillingCity</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Order_Variables</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Order_Variables</name>
        <label>Assign Order Variables</label>
        <locationX>1505</locationX>
        <locationY>851</locationY>
        <assignmentItems>
            <assignToReference>var_Order.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ContractId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>createContract</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.CurrencyIsoCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.CurrencyIsoCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.CustomerReference__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.OrderReference__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.EffectiveDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.OperatingCompany__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.OperatingCompany__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.OpportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.PaymentMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Invoice</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.Pricebook2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Pricebook2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.PricingMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.PricingMethod__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ShipbyDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ShippingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.ShippingCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ShippingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.ShippingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ShippingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.ShippingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.ShippingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getAccount.ShippingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.Shipto__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>B2B Salesforce</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Order.Type</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>RegularOrder</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>newOrder</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssItemtoList</name>
        <label>AssItemtoList</label>
        <locationX>529</locationX>
        <locationY>983</locationY>
        <assignmentItems>
            <assignToReference>newOrderLineItemList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>singleOrderItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loopAddOpportunityItems</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assNewContractStatus</name>
        <label>assNewContractStatus</label>
        <locationX>1836</locationX>
        <locationY>1175</locationY>
        <assignmentItems>
            <assignToReference>getContract.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getContract.StartDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getContract.ContractTerm</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varContractTerms</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getContract.OriginalStartDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getContract.OriginalTerm__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varContractTerms</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decIsProfessional</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assNewContractStatus_0</name>
        <label>assNewContractStatus</label>
        <locationX>2133</locationX>
        <locationY>1028</locationY>
        <assignmentItems>
            <assignToReference>getContract.OperatingCompany__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Noordhoff Professional</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>updateContract</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assStartDateFromContractStart</name>
        <label>assStartDateFromContractStart</label>
        <locationX>1991</locationX>
        <locationY>529</locationY>
        <assignmentItems>
            <assignToReference>startDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ContractStartDate__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decDefaultBillTo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assStartDateFromToday</name>
        <label>assStartDateFromToday</label>
        <locationX>1806</locationX>
        <locationY>614</locationY>
        <assignmentItems>
            <assignToReference>startDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentDay</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decDefaultBillTo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>updateNewOrder</name>
        <label>updateNewOrder</label>
        <locationX>1024</locationX>
        <locationY>1415</locationY>
        <assignmentItems>
            <assignToReference>getOrdertoUpdate.TriggerBusinessRules__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getOrdertoUpdate.EffectiveDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>getOrdertoUpdate.ShipbyDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>startDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOrderTriggerBusinessRules</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>updateNewOrder_0</name>
        <label>updateNewOrder</label>
        <locationX>1023</locationX>
        <locationY>1214</locationY>
        <assignmentItems>
            <assignToReference>getOrdertoUpdate.TriggerBusinessRules__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOrderTriggerBusinessRules</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>decContractDate</name>
        <label>decContractDate</label>
        <locationX>181</locationX>
        <locationY>1014</locationY>
        <defaultConnector>
            <targetReference>AssItemtoList</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ContractDate</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>loopAddOpportunityItems.ServiceDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>loopAddOpportunityItems.ServiceDate</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>startDate</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>startDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assContractVarsDate</targetReference>
            </connector>
            <label>ContractDate</label>
        </rules>
    </decisions>
    <decisions>
        <name>decContractTerms</name>
        <label>decContractTerms</label>
        <locationX>273</locationX>
        <locationY>747</locationY>
        <defaultConnector>
            <targetReference>decContractDate</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ContractTerms</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>loopAddOpportunityItems.Terms__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varContractTerms</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>loopAddOpportunityItems.Terms__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>varContractTerms</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assContractVarsTerms</targetReference>
            </connector>
            <label>ContractTerms</label>
        </rules>
    </decisions>
    <decisions>
        <name>decDefaultBillTo</name>
        <label>decDefaultBillTo</label>
        <locationX>2041</locationX>
        <locationY>810</locationY>
        <defaultConnector>
            <targetReference>Assign_Opp_Account_as_BillTo</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Default BillTo</defaultConnectorLabel>
        <rules>
            <name>Default_BiilTo</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getAccount.DefaultBillto__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Default_BillTo_from_Account</targetReference>
            </connector>
            <label>Default BiilTo</label>
        </rules>
    </decisions>
    <decisions>
        <name>decIsProfessional</name>
        <label>decIsProfessional</label>
        <locationX>2022</locationX>
        <locationY>1244</locationY>
        <defaultConnector>
            <targetReference>updateContract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Professional</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>frmCheckPricebook</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assNewContractStatus_0</targetReference>
            </connector>
            <label>Professional</label>
        </rules>
    </decisions>
    <decisions>
        <name>decIsProfessional_0</name>
        <label>decIsProfessional</label>
        <locationX>817</locationX>
        <locationY>1349</locationY>
        <defaultConnector>
            <targetReference>updateNewOrder_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>IsProfessionalOrder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>frmCheckPricebook</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>updateNewOrder</targetReference>
            </connector>
            <label>IsProfessionalOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>decIsProfessional_0_0</name>
        <label>decIsProfessional</label>
        <locationX>852</locationX>
        <locationY>383</locationY>
        <defaultConnector>
            <targetReference>getAccount</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Professional_MBO_HBO_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>frmCheckPricebook</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$UserRole.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Noordhoff Professional MBO HBO Sales User</stringValue>
                </rightValue>
            </conditions>
            <label>Professional MBO/HBO User</label>
        </rules>
        <rules>
            <name>IsProfessionalOrder_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>frmCheckPricebook</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>createContract</targetReference>
            </connector>
            <label>IsProfessionalOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>decIsProfessional_0_0_0</name>
        <label>decIsProfessional</label>
        <locationX>1499</locationX>
        <locationY>1156</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>IsProfessionalOrder_0_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>frmCheckPricebook</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>getContract</targetReference>
            </connector>
            <label>IsProfessionalOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>decStartDate</name>
        <label>decStartDate</label>
        <locationX>1576</locationX>
        <locationY>532</locationY>
        <defaultConnector>
            <targetReference>assStartDateFromToday</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>startDatenotNull</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ContractStartDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assStartDateFromContractStart</targetReference>
            </connector>
            <label>startDatenotNull</label>
        </rules>
    </decisions>
    <description>CH 25/04/2023 - Added reference assignment
DB 30/05/2023 - Updated entry criteria to only allow NH Professional Opportunities to trigger the process
DB 30/05/2023 - Updated BillTo assignment if there&apos;s a default on the Account
DB 12/06/2023 - Added CustomerRef assignment for order item</description>
    <environments>Default</environments>
    <formulas>
        <name>BypassValidationToggleFormula</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Record.Is_Validation_Bypassed__c} = TRUE, FALSE, TRUE)</expression>
    </formulas>
    <formulas>
        <name>CurrentDay</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <formulas>
        <name>frmCheckPricebook</name>
        <dataType>Boolean</dataType>
        <expression>IF(CONTAINS({!$Record.Pricebook2.Name}, &apos;Professional&apos;), True, false)</expression>
    </formulas>
    <formulas>
        <name>frmContractTerms</name>
        <dataType>Number</dataType>
        <expression>IF({!$Record.ContractTermmonths__c} != null, {!$Record.ContractTermmonths__c}, 1)</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Opportunity_ClosedWon {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity_ClosedWon</label>
    <loops>
        <name>loopAddOpportunityItems</name>
        <label>loopAddOpportunityItems</label>
        <locationX>838</locationX>
        <locationY>753</locationY>
        <collectionReference>getOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assEachOrderItem</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>createOrderLines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>createContract</name>
        <label>createContract</label>
        <locationX>1228</locationX>
        <locationY>360</locationY>
        <connector>
            <targetReference>getAccount</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractRenewalType__c</field>
            <value>
                <elementReference>$Record.ContractRenewalType__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CurrencyIsoCode</field>
            <value>
                <elementReference>$Record.CurrencyIsoCode</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CustomerReference__c</field>
            <value>
                <elementReference>$Record.OrderReference__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>$Record.Name</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OperatingCompany__c</field>
            <value>
                <elementReference>$Record.OperatingCompany__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Pricebook2Id</field>
            <value>
                <elementReference>$Record.Pricebook2Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PricingMethod__c</field>
            <value>
                <elementReference>$Record.PricingMethod__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingCostMethod__c</field>
            <value>
                <stringValue>Based on weight Domestic</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StartDate</field>
            <value>
                <elementReference>$Record.ContractStartDate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>defaultBilltoAccount__c</field>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>createOrderLines</name>
        <label>createOrderLines</label>
        <locationX>886</locationX>
        <locationY>1050</locationY>
        <connector>
            <targetReference>OpportunityConvertHandler</targetReference>
        </connector>
        <inputReference>newOrderLineItemList</inputReference>
    </recordCreates>
    <recordCreates>
        <name>newOrder</name>
        <label>newOrder</label>
        <locationX>1287</locationX>
        <locationY>870</locationY>
        <connector>
            <targetReference>getOpportunityLineItems</targetReference>
        </connector>
        <inputReference>var_Order</inputReference>
    </recordCreates>
    <recordLookups>
        <name>getAccount</name>
        <label>getAccount</label>
        <locationX>1356</locationX>
        <locationY>517</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>decStartDate</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getContract</name>
        <label>getContract</label>
        <locationX>1658</locationX>
        <locationY>1220</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>assNewContractStatus</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>createContract</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getOpportunityLineItems</name>
        <label>getOpportunityLineItems</label>
        <locationX>1062</locationX>
        <locationY>870</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>loopAddOpportunityItems</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getOrdertoUpdate</name>
        <label>getOrdertoUpdate</label>
        <locationX>514</locationX>
        <locationY>1373</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>decIsProfessional_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>var_Order.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>updateContract</name>
        <label>updateContract</label>
        <locationX>2389</locationX>
        <locationY>1219</locationY>
        <connector>
            <targetReference>updateOpportunity</targetReference>
        </connector>
        <inputReference>getContract</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>updateOpportunity</name>
        <label>updateOpportunity</label>
        <locationX>2212</locationX>
        <locationY>1505</locationY>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>createContract</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_Validation_Bypassed__c</field>
            <value>
                <elementReference>BypassValidationToggleFormula</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateOrderTriggerBusinessRules</name>
        <label>UpdateOrderTriggerBusinessRules</label>
        <locationX>1403</locationX>
        <locationY>1292</locationY>
        <connector>
            <targetReference>decIsProfessional_0_0_0</targetReference>
        </connector>
        <inputReference>getOrdertoUpdate</inputReference>
    </recordUpdates>
    <start>
        <locationX>304</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>decIsProfessional_0_0</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterLogic>and</filterLogic>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </filters>
        <filters>
            <field>OpportunityRecordTypeName__c</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Professional</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>newOrderLineItemList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>singleOrderItem</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>startDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>var_Order</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Order</objectType>
    </variables>
    <variables>
        <name>varContractTerms</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
</Flow>
